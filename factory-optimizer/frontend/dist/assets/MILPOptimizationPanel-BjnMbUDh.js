import{c as u,r as j,l as b,j as e,C as g,S as N,L as v,P as f,Z as m,a as o,B as y,n as x,m as d,h as w,e as C}from"./index-BQX9U8G4.js";const _=u("Sliders",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]),k="http://127.0.0.1:8000";async function z(s){const t=await fetch(`${k}/optimization/schedule/demo`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({num_jobs:15,num_machines:4,solver:"cpsat",time_limit_seconds:s.time_limit})});if(!t.ok)throw new Error("Failed to run optimization");return t.json()}const r=({label:s,value:t,min:l,max:a,step:i=1,unit:n="",onChange:h})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-400",children:s}),e.jsxs("span",{className:"text-white font-medium",children:[t,n]})]}),e.jsx("input",{type:"range",min:l,max:a,step:i,value:t,onChange:p=>h(Number(p.target.value)),className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-cyan-500"}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[e.jsxs("span",{children:[l,n]}),e.jsxs("span",{children:[a,n]})]})]}),P=({value:s,onChange:t})=>{const l=[{id:"tardiness",label:"Minimizar Atrasos",icon:e.jsx(o,{className:"w-4 h-4"}),color:"cyan"},{id:"makespan",label:"Minimizar Makespan",icon:e.jsx(C,{className:"w-4 h-4"}),color:"purple"},{id:"balanced",label:"Balanceado",icon:e.jsx(x,{className:"w-4 h-4"}),color:"emerald"}];return e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Objetivo Principal"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:l.map(a=>e.jsxs("button",{onClick:()=>t(a.id),className:`flex items-center gap-2 p-3 rounded-lg border transition-all ${s===a.id?`bg-${a.color}-500/20 border-${a.color}-500/50 text-${a.color}-400`:"bg-slate-800/50 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[a.icon,e.jsx("span",{className:"text-sm font-medium",children:a.label})]},a.id))})]})},c=({label:s,value:t,unit:l,icon:a,trend:i,trendValue:n})=>e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm mb-2",children:[a,s]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("p",{className:"text-2xl font-bold text-white",children:[t,l&&e.jsx("span",{className:"text-sm text-slate-400 ml-1",children:l})]}),n&&e.jsx("span",{className:`text-sm ${i==="down"?"text-emerald-400":i==="up"?"text-red-400":"text-slate-400"}`,children:n})]})]}),M=({comparison:s})=>{const t=Math.max(s.milp?.tardiness||0,s.heuristic?.tardiness||0,1);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-400",children:"Comparação MILP vs Heurística"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-20 text-sm text-slate-400",children:"MILP"}),e.jsx("div",{className:"flex-1 h-8 bg-slate-700 rounded overflow-hidden",children:e.jsx(d.div,{initial:{width:0},animate:{width:`${(s.milp?.tardiness||0)/t*100}%`},className:"h-full bg-gradient-to-r from-cyan-500 to-blue-500 flex items-center justify-end px-2",children:e.jsxs("span",{className:"text-xs text-white font-medium",children:[s.milp?.tardiness?.toFixed(0)||0," min"]})})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-20 text-sm text-slate-400",children:"Heurística"}),e.jsx("div",{className:"flex-1 h-8 bg-slate-700 rounded overflow-hidden",children:e.jsx(d.div,{initial:{width:0},animate:{width:`${(s.heuristic?.tardiness||0)/t*100}%`},className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-end px-2",children:e.jsxs("span",{className:"text-xs text-white font-medium",children:[s.heuristic?.tardiness?.toFixed(0)||0," min"]})})})]})]}),s.improvement_percent!==void 0&&e.jsx("div",{className:`text-center p-3 rounded-lg ${s.improvement_percent>0?"bg-emerald-500/10 border border-emerald-500/30":"bg-slate-800/50 border border-slate-700"}`,children:e.jsxs("span",{className:s.improvement_percent>0?"text-emerald-400":"text-slate-400",children:[s.improvement_percent>0?"↓":"→"," ",Math.abs(s.improvement_percent).toFixed(1),"%",s.improvement_percent>0?" melhoria com MILP":" diferença"]})})]})},O=()=>{const[s,t]=j.useState({time_limit:30,gap_tolerance:.05,objective:"balanced",weights:{tardiness:.5,makespan:.3,utilization:.2}}),l=b({mutationFn:()=>z(s)}),a=l.data;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5 text-cyan-500"}),"Otimização MILP (CP-SAT)"]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Configuração avançada para otimização de scheduling"})]})}),e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-5 space-y-6",children:[e.jsxs("div",{className:"rounded-xl border border-slate-700/50 bg-slate-800/30 p-6 space-y-6",children:[e.jsxs("h3",{className:"font-medium text-white flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-slate-400"}),"Configuração do Solver"]}),e.jsx(r,{label:"Limite de Tempo",value:s.time_limit,min:5,max:120,step:5,unit:"s",onChange:i=>t({...s,time_limit:i})}),e.jsx(r,{label:"Gap Tolerance",value:s.gap_tolerance*100,min:1,max:20,step:1,unit:"%",onChange:i=>t({...s,gap_tolerance:i/100})}),e.jsx(P,{value:s.objective,onChange:i=>t({...s,objective:i})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Pesos dos Objetivos"}),e.jsx(r,{label:"Tardiness",value:s.weights.tardiness*100,min:0,max:100,step:5,unit:"%",onChange:i=>t({...s,weights:{...s.weights,tardiness:i/100}})}),e.jsx(r,{label:"Makespan",value:s.weights.makespan*100,min:0,max:100,step:5,unit:"%",onChange:i=>t({...s,weights:{...s.weights,makespan:i/100}})}),e.jsx(r,{label:"Utilização",value:s.weights.utilization*100,min:0,max:100,step:5,unit:"%",onChange:i=>t({...s,weights:{...s.weights,utilization:i/100}})})]}),e.jsx("button",{onClick:()=>l.mutate(),disabled:l.isPending,className:"w-full flex items-center justify-center gap-2 py-3 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white font-semibold rounded-lg transition-all disabled:opacity-50",children:l.isPending?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-5 h-5 animate-spin"}),"Otimizando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"w-5 h-5"}),"Executar Otimização"]})})]}),e.jsx("div",{className:"rounded-xl border border-cyan-500/20 bg-cyan-500/5 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(m,{className:"w-5 h-5 text-cyan-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-cyan-400",children:"Sobre CP-SAT"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"O Google OR-Tools CP-SAT é um solver de constraint programming que encontra soluções ótimas ou near-optimal para problemas de scheduling."})]})]})})]}),e.jsx("div",{className:"col-span-7 space-y-6",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(c,{label:"Tardiness Total",value:a.schedule.total_tardiness.toFixed(0),unit:"min",icon:e.jsx(o,{className:"w-4 h-4"})}),e.jsx(c,{label:"Makespan",value:a.schedule.total_makespan_minutes.toFixed(0),unit:"min",icon:e.jsx(y,{className:"w-4 h-4"})}),e.jsx(c,{label:"Jobs Agendados",value:a.schedule.job_count,icon:e.jsx(x,{className:"w-4 h-4"})}),e.jsx(c,{label:"Tempo de Solução",value:a.schedule.solve_time_seconds.toFixed(2),unit:"s",icon:e.jsx(m,{className:"w-4 h-4"})})]}),a.comparison&&e.jsx("div",{className:"rounded-xl border border-slate-700/50 bg-slate-800/30 p-6",children:e.jsx(M,{comparison:a.comparison})}),e.jsxs("div",{className:"rounded-xl border border-slate-700/50 bg-slate-800/30 p-6",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-400 mb-4",children:"Utilização por Máquina"}),e.jsx("div",{className:"space-y-3",children:Object.entries(a.schedule.machine_utilization).map(([i,n])=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-16 text-sm text-slate-400",children:i}),e.jsx("div",{className:"flex-1 h-4 bg-slate-700 rounded overflow-hidden",children:e.jsx(d.div,{initial:{width:0},animate:{width:`${n*100}%`},className:`h-full ${n>.8?"bg-emerald-500":n>.5?"bg-cyan-500":"bg-amber-500"}`})}),e.jsxs("span",{className:"w-12 text-sm text-slate-400 text-right",children:[(n*100).toFixed(0),"%"]})]},i))})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-4 rounded-xl bg-emerald-500/10 border border-emerald-500/30",children:[e.jsx(w,{className:"w-5 h-5 text-emerald-400"}),e.jsxs("span",{className:"text-emerald-400 font-medium",children:["Otimização concluída com solver ",a.schedule.solver_used.toUpperCase()]})]})]}):e.jsx("div",{className:"h-full flex items-center justify-center rounded-xl border border-slate-700/50 bg-slate-800/30 p-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(_,{className:"w-16 h-16 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium text-slate-400",children:"Configure e execute a otimização"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:'Ajuste os parâmetros e clique em "Executar Otimização"'})]})})})]})]})};export{O as MILPOptimizationPanel,O as default};
